{% extends "base.html" %}

{% block header %}👤 Search Users{% endblock %}

{% block content %}
<p>Search for user profiles by username.</p>

<!-- Search Form -->
<form method="POST">
    <label for="user_name">Enter Username to Search</label>
    <input type="text" name="user_name" value="{{ user_name }}" required><br>

    <label for="query_text">Search Query Text (optional)</label>
    <input type="text" name="query_text" value="{{ query_text }}"><br>

    <label for="query_category">Filter by Category (optional)</label>
    <input type="text" name="query_category" value="{{ query_category }}"><br>

    <button type="submit">Search</button>
</form>

<!-- Display User Profile Bubbles -->
{% if profile %}
    <h3>Bubbles for User: {{ user_name }}</h3>
    <div class="bubble-list">
        {% for bubble in profile.bubbles %}
            <div class="bubble-item">
                {% if bubble.category %}
                    <li>🎉 {{ bubble.content }} <i>in #{{ bubble.category }}</i> <br> <small>{{ bubble.created_at_str }}</small></li>
                {% else %}
                    <li>🎉 {{ bubble.content }} <br> <small>{{ bubble.created_at_str }}</small></li>
                {% endif %}
            </div>
        {% endfor %}
    </div>

    <!-- Pagination Controls -->
    <div class="pagination">
        {% if offset > 0 %}
            <a href="{{ url_for('users', user_name=user_name, query_text=query_text, query_category=query_category, offset=offset - 5) }}">⬅️ Previous</a>
        {% endif %}

        {% if has_more %}
            <a href="{{ url_for('users', user_name=user_name, query_text=query_text, query_category=query_category, offset=offset + 5) }}">Next ➡️</a>
        {% endif %}
    </div>
{% endif %}

<!-- Back to Main Menu -->
<footer>
    <p><a href="{{ url_for('menu') }}">⬅️ Back to Main Menu</a></p>
</footer>
{% endblock %}
