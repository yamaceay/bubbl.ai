{% extends "base.html" %}

{% block header %}🔍 Bubble Feed{% endblock %}

{% block content %}
<p>Search for bubbles by content, user, or category.</p>

<!-- Search Form -->
<form method="POST">
    <label for="query">Search Query (optional)</label>
    <input type="text" name="query" value="{{ query }}"><br>

    <label for="query_category">Filter by Category (optional)</label>
    <input type="text" name="query_category" value="{{ query_category }}"><br>

    <button type="submit">Search</button>
</form>

<!-- Display Results -->
{% if bubbles %}
<h3>Search Results</h3>
    <div class="bubble-list">
        {% for bubble in bubbles %}
            <div class="bubble-item">
                {% if bubble.category %}
                    <li>🎉 {{ bubble.content }} <i>by @{{ bubble.user }} in #{{ bubble.category }}</i> <br> <small>{{ bubble.created_at_str }}</small></li>
                {% else %}
                    <li>🎉 {{ bubble.content }} <i>by @{{ bubble.user }}</i> <br> <small>{{ bubble.created_at_str }}</small></li>
                {% endif %}
            </div>
        {% endfor %}
    </div>

    <!-- Pagination Controls -->
    <div class="pagination">
        {% if offset > 0 %}
            <a href="{{ url_for('feed', query=query, query_category=query_category, limit=limit, offset=offset - limit) }}">⬅️ Previous</a>
        {% endif %}

        {% if has_more %}
            <a href="{{ url_for('feed', query=query, query_category=query_category, limit=limit, offset=offset + limit) }}">Next ➡️</a>
        {% endif %}
    </div>
{% endif %}

<!-- Back to Main Menu -->
<footer>
    <p><a href="{{ url_for('menu') }}">⬅️ Back to Main Menu</a></p>
</footer>
{% endblock %}
