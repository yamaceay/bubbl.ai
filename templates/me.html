{% extends "base.html" %}

{% block header %}🎨 My Bubbles{% endblock %}

{% block content %}
<p>Blow your own bubbles and let your creativity flow!</p>

<!-- Create New Bubble Form -->
<form method="POST" action="{{ url_for('me') }}">
    <label for="content">Blow a New Bubble:</label>
    <textarea name="content" placeholder="What's on your mind?"></textarea>
    <label for="category">Category:</label>
    <input type="text" name="category" placeholder="Category (optional)">
    <button type="submit" name="create_bubble" class="create-bubble">Blow Bubble 💭</button>
</form>

<!-- Display Existing Bubbles -->
<h3>Your Bubbles 🫧</h3>
<div class="bubble-list">
    {% if profile and profile.bubbles %}
        {% for bubble in profile.bubbles %}
        <div class="bubble-item">
            {% if bubble.category %}
                <li>🎉 {{ bubble.content }} <i>in #{{ bubble.category }}</i> <br> <small>{{ bubble.created_at_str }}</small></li>
            {% else %}
                <li>🎉 {{ bubble.content }} <br> <small>{{ bubble.created_at_str }}</small></li>
            {% endif %}
            <!-- Red Cross for deletion -->
            <form method="POST" class="delete-form">
                <input type="hidden" name="bubble_id" value="{{ bubble.uuid }}">
                <button type="submit" name="remove_bubble" class="delete-bubble">❌</button>
            </form>
        </div>
        {% endfor %}
    {% else %}
        <p>No bubbles found. Start creating your own bubbles!</p>
    {% endif %}
</div>

<!-- Pagination Controls -->
<div class="pagination">
    {% if offset > 0 %}
    <a href="{{ url_for('me', offset=offset - limit) }}">⬅️ Previous</a>
    {% endif %}
    {% if has_more %}
    <a href="{{ url_for('me', offset=offset + limit) }}">Next ➡️</a>
    {% endif %}
</div>

<footer>
    <p><a href="{{ url_for('menu') }}">⬅️ Back to Main Menu</a></p>
</footer>
{% endblock %}
